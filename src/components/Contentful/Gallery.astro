---
import type { TypeContentGallery } from '../../lib/__generated__';
import { cn } from '../../lib/cn';
import CardProject from '../CardProject.astro';
import GalleryComponent from '../Gallery.astro';

interface Props {
  data?: TypeContentGallery<'WITHOUT_UNRESOLVABLE_LINKS'>;
  class?: string;
  experiencesRoute?: string;
}

const { data, class: className = '' } = Astro.props as Props;

if (!data?.fields) return null;

const media = data.fields.media ?? [];
const itemsToUse = media.slice(0, 7);
---

<GalleryComponent class={cn('', className)}>
  {
    itemsToUse.map((item, index) => {
      const page = item.fields;
      const project = page?.project?.fields;

      return (
        <CardProject
          class={index >= 5 ? 'hidden md:flex' : undefined}
          href={page?.slug ? `/${page.slug}` : '#'}
          project={{
            logo: project?.logo,
            theme: project?.theme?.value ?? '#000000',
            name: project?.name,
            logos: project?.technologies?.map((tech) => ({
              title: tech?.fields?.name,
              src:
                tech?.fields?.logo?.fields?.mobile?.fields?.file?.url ??
                tech?.fields?.logo?.fields?.tablet?.fields?.file?.url ??
                tech?.fields?.logo?.fields?.desktop?.fields?.file?.url ??
                '',
            })),
          }}
        />
      );
    })
  }

  <CardProject
    key="see-more"
    href="/experiences"
    project={{ name: 'SEE MORE', theme: '#000000' }}
    class="*:text-white"
  />
</GalleryComponent>
